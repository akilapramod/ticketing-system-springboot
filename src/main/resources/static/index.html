<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ticket Management System</title>
</head>
<body>
<h1>Ticket Management System</h1>
<form id="configForm">
    <label for="maxTicketCapacity">Max Ticket Capacity:</label>
    <input type="number" id="maxTicketCapacity" name="maxTicketCapacity"><br><br>
    <label for="totalTickets">Total Tickets:</label>
    <input type="number" id="totalTickets" name="totalTickets"><br><br>
    <label for="ticketReleaseRate">Ticket Release Rate:</label>
    <input type="number" id="ticketReleaseRate" name="ticketReleaseRate"><br><br>
    <label for="ticketRetrievalRate">Ticket Retrieval Rate:</label>
    <input type="number" id="ticketRetrievalRate" name="ticketRetrievalRate"><br><br>
    <button type="button" onclick="setConfiguration()">Set Configuration</button>
</form>
<button onclick="startSystem()">Start System</button>
<button onclick="stopSystem()">Stop System</button>

<div id="ticketActivities">
    <h2>Recent Ticket Activities</h2>
    <table id="activitiesTable">
        <thead>
        <tr>
            <th>Time</th>
            <th>Activity</th>
            <th>Ticket ID</th>
            <th>Actor</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>


<script>
    async function setConfiguration() {
        const config = {
            maxTicketCapacity: document.getElementById('maxTicketCapacity').value,
            totalTickets: document.getElementById('totalTickets').value,
            ticketReleaseRate: document.getElementById('ticketReleaseRate').value,
            ticketRetrievalRate: document.getElementById('customerRetrievalRate').value
        };
        await fetch('/api/configuration/set', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(config)
        });
    }

    async function startSystem() {
        await fetch('/api/configuration/start', {
            method: 'POST'
        });
    }

    async function stopSystem() {
        await fetch('/api/configuration/stop', {
            method: 'POST'
        });
    }

    async function updateActivities() {
        try {
            const response = await fetch('/api/activities/recent');
            const activities = await response.json();
            const tbody = document.querySelector('#activitiesTable tbody');
            tbody.innerHTML = '';

            activities.forEach(activity => {
                const row = tbody.insertRow();
                row.insertCell(0).textContent = new Date(activity.timestamp).toLocaleString();
                row.insertCell(1).textContent = activity.activityType;
                row.insertCell(2).textContent = activity.ticketId;
                row.insertCell(3).textContent = `${activity.actorType}: ${activity.actorId}`;
            });
        } catch (error) {
            console.error('Error updating activities:', error);
        }
    }

    // Update activities every 5 seconds
    setInterval(updateActivities, 5000);
</script>
</body>
</html>
